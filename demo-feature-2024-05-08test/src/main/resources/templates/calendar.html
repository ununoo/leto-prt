<!DOCTYPE html>
<html>

<head>
    <!-- Basic -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- Mobile Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <!-- Site Metas -->
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <link rel="shortcut icon" href="/images/Logo.png" type="">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="https://ssl.pstatic.net/static.datalab/202405030736/css/datalab.css">
    <title> LETO Trends </title>
    <link rel="stylesheet" href="index_result.css">
    <script src="https://cdn.anychart.com/releases/8.7.1/js/anychart-core.min.js"></script>
    <script src="https://cdn.anychart.com/releases/8.7.1/js/anychart-heatmap.min.js"></script>
    <style>
        html, body, #container {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }
        .item2 {
            text-align: left;
        }

        .grid-container {
            width: 100%;
            display: flex; /* 변경: flexbox 사용 */
            flex-direction: column; /* 변경: 세로 정렬 */
            align-items: center; /* 추가: 아이템을 가운데 정렬 */
            justify-content: center; /* 추가: 전체 컨테이너 가운데 정렬 */
            grid-gap: 20px; /* grid-gap 대신 여전히 사용 가능 */
            text-align: center; /* 텍스트 가운데 정렬 */
        }
        .item1 {
            padding-top: 60px; /* 필요에 따라 값을 조정 */
            justify-content: center;
            text-align: center; /* 텍스트 가운데 정렬 */
            align-items: center;
            align-self: center;
            align-content: center;
        }
        .item1 h1 {
            font-weight: bold;
            margin-bottom: 20px;
        }
        .item1 h1 span {
            color: #00bbf0;
        }
        .item1 {
            width: 100%;
        }
        .service_section {
            display: block;
            position: relative;
            text-align: center;
            margin-bottom: 20px; /* 추가: 조회 필터와 히트맵 캘린더 간격 조정 */
        }
        #container {
            margin-top: 20px; /* 추가: 조회 필터와 히트맵 캘린더 간격 조정 */
        }
        .item4 {
            justify-content: center; /* 가로 가운데 정렬 */
            text-align: center; /* 텍스트 가운데 정렬 */
        }
        .custom-btn {
            display: inline-block;
            font-family: 'Arial', sans-serif;
            font-size: 16px;
            padding: 10px 20px 8px 20px;
            background-color: #FFFFFF;
            border: 2px solid #FFFFFF;
            /*border-radius: 5px; !* 둥근 모서리 *!*/
            cursor: pointer; /* 마우스 포인터 모양 변경 */
            /*box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); !* 그림자 추가 *!*/
            font-weight: bold; /* 폰트 굵기 조정 */
            transition: background-color 0.3s, transform 0.3s; /* 배경색과 크기 변화 트랜지션 */
            text-decoration: none;
            margin: 0px 5px 0px 5px;
            color: #B0B0B0;
        }
        .custom-btn:hover {
            background-color: #d8dbdf; /* 조금 더 짙은 회색 */
            transform: translateY(-2px);
        }
        /*.custom-btn:active {*/
        /*    background-color: #545b62; !* 조금 더 짙은 회색 *!*/
        /*    transform: translateY(-2px);*/
        /*}*/
        input[type="text"] {
            padding: 10px;
            border: 2px solid #ccc;
            border-radius: 5px;
            margin-right: 10px;
            font-size: 16px;
        }
        .fixed-button {
            position: fixed;
            bottom: 20px; /* 화면 하단에서 20px 위 */
            right: 20px; /* 화면 오른쪽에서 20px 왼쪽 */
            padding: 10px 20px;
            background-color: #6c757d; /* 버튼의 기본 배경색 (회색) */
            color: #fff; /* 텍스트 색상 */
            border: none; /* 테두리 제거 */
            border-radius: 5px; /* 둥근 모서리 */
            cursor: pointer; /* 마우스 포인터 모양 변경 */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* 그림자 추가 */
            font-size: 16px; /* 폰트 크기 조정 */
            font-weight: bold; /* 폰트 굵기 조정 */
            transition: background-color 0.3s, transform 0.3s; /* 배경색과 크기 변화 트랜지션 */
            z-index: 1000;
        }

        .fixed-button:hover {
            background-color: #5a6268; /* 호버 시 배경색 (더 어두운 회색) */
            transform: translateY(-2px); /* 호버 시 약간 위로 이동 */
        }

        .fixed-button:active {
            background-color: #545b62; /* 클릭 시 배경색 (더 어두운 회색) */
            transform: translateY(1px); /* 클릭 시 약간 아래로 이동 */
        }

        .fixed-button:focus {
            outline: none; /* 포커스 시 기본 테두리 제거 */
            box-shadow: 0 0 0 3px rgba(108, 117, 125, 0.5); /* 포커스 시 테두리 그림자 */
        }
        body.dark-mode {
            color: #f2f2f2;
            background-color: #18283b;
        }
        select {
            border: 2px solid #ccc;
            border-radius: 5px;
            margin-right: 10px;
            font-size: 16px;
        }
        #container {
            width: 100%;
            height: 500px;
            padding: 20px;
            box-sizing: border-box;
            overflow-y: auto;
        }
        body.dark-mode #container {
            background-color: #18283B; /* 다크 모드 배경색 */
            color: #fff; /* 다크 모드 텍스트 색상 */
        }
        body.dark-mode .custom-btn1 {
            color: #f2f2f2; /* 다크 모드일 때 버튼 텍스트 색상 */
            background-color: #18283b; /* 다크 모드일 때 버튼 배경색 */
        }
        body.dark-mode .custom-btn1:focus {
            box-shadow: 0 0 0 3px rgba(108, 117, 125, 0.5); /* 다크 모드일 때 버튼 포커스 테두리 색상 */
        }
        body.dark-mode .custom-btn {
            background-color: #18283B;
        }
    </style>
    <!-- bootstrap core css -->
    <link rel="stylesheet" type="text/css" href="/css/bootstrap.css" />

    <!-- fonts style -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">

    <!--owl slider stylesheet -->
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css" />

    <!-- font awesome style -->
    <link href="/css/font-awesome.min.css" rel="stylesheet" />

    <!-- Custom styles for this template -->
    <link href="/css/style.css" rel="stylesheet" />
    <!-- responsive style -->
    <link href="/css/responsive.css" rel="stylesheet" />

    <script>
        function pageUrl() {
            var sHref = decodeURI(location.href);
            return sHref;
        }

        window.onscroll = function() {
            var button = document.getElementById("fixedButton");
            var scrollTop = window.scrollY || document.documentElement.scrollTop;
            var windowHeight = window.innerHeight || document.documentElement.clientHeight;
            var buttonHeight = button.offsetHeight;

            // 버튼을 고정시킬 위치 계산
            var buttonTopPosition = windowHeight - buttonHeight - 20; // 우측 하단에 여백 20px을 두고 버튼을 배치

            // 현재 스크롤 위치가 버튼을 고정시킬 위치를 넘었을 때 버튼을 고정시킴
            if (scrollTop > buttonTopPosition) {
                button.style.position = "fixed";
                button.style.bottom = "20px"; // 여백 조정
                button.style.right = "20px"; // 여백 조정
            } else {
                button.style.position = "static"; // 스크롤이 버튼을 넘지 않으면 버튼 위치를 원래대로 설정
            }
        };
        function logout() {
            alert('로그아웃되었습니다.');
            window.location.href = '/member/logout';
        }
    </script>
    <script>
        function toggleAllCheckboxes(group, source) {
            const checkboxes = document.querySelectorAll(`input[name=${group}]`);
            checkboxes.forEach(checkbox => {
                checkbox.checked = false; // 모든 체크박스를 해제
            });
            source.checked = true; // 전체 체크박스만 체크
        }

        function updateAllCheckbox(group, allCheckboxId) {
            const checkboxes = document.querySelectorAll(`input[name=${group}]`);
            const allCheckbox = document.getElementById(allCheckboxId);

            const anyChecked = Array.from(checkboxes).some(checkbox => checkbox.checked);

            if (anyChecked) {
                allCheckbox.checked = false; // 다른 체크박스가 하나라도 체크되어 있으면 전체 체크박스 해제
            } else {
                allCheckbox.checked = true; // 다른 체크박스가 하나도 체크되어 있지 않으면 전체 체크박스 체크
            }
        }


        function validateCheckboxSelection() {
            // 첫 번째 그룹 'age'에 대한 검증
            const ageCheckboxes = document.querySelectorAll('input[name="age"]');
            const anyAgeChecked = Array.from(ageCheckboxes).some(checkbox => checkbox.checked);

            // 두 번째 그룹 'age2'에 대한 검증
            const age2Checkboxes = document.querySelectorAll('input[name="age2"]');
            const anyAge2Checked = Array.from(age2Checkboxes).some(checkbox => checkbox.checked);

            // 두 그룹 중 하나라도 선택되지 않은 경우 경고
            if(!anyAgeChecked){
                alert("Group A에서 최소한 하나의 연령을 선택해주세요.")
                return false;
            }

            if(!anyAge2Checked){
                alert("Group B에서 최소한 하나의 연령을 선택해주세요.")
                return false;
            }
            return true;
        }

        document.addEventListener('DOMContentLoaded', (event) => {
            const searchButton = document.getElementById('search_button');
            searchButton.addEventListener('click', (event) => {
                if (!validateCheckboxSelection()) {
                    event.preventDefault(); // 폼 제출 방지
                }
            });
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const selectDayType1 = document.getElementById('selectDayType');
            const selectDayType2 = document.getElementById('selectDayType2');

            function syncSelectBoxes(source, target) {
                target.value = source.value;
            }

            selectDayType1.addEventListener('change', function () {
                syncSelectBoxes(selectDayType1, selectDayType2);
            });

            selectDayType2.addEventListener('change', function () {
                syncSelectBoxes(selectDayType2, selectDayType1);
            });
        });
    </script>
</head>

<body class="sub_page">

<div class="hero_area">
    <div th:insert="~{/fragments/topFragment :: topFragment}"></div>
</div>

<section>
    <div class="grid-container">
        <form method="get" id="myForm">
            <div class="item1">
                <h1>
                    히트맵 캘린더
                </h1>
                <br>
                <input type="text" placeholder="검색어1(필수)" name="query1" id="query1" required/>

                <input type="hidden" id="hidden1" placeholder="검색어2" name="query2"/>
                <input type="hidden" id="hidden2" placeholder="검색어3" name="query3"/>
                <input type="hidden" id="hidden3" placeholder="검색어4" name="query4"/>
                <input type="hidden" id="hidden4" placeholder="검색어5" name="query5"/>

                <button class="custom-btn btn-7" type="button" id="addSearchBox" style="display: none;">
                    <i class="fas fa-plus"></i>
                </button>
                <button type="button" class="custom-btn btn-7" onclick="resetForm()">
                    <i class="fas fa-trash-alt"></i>
                </button>
                <script>
                    function resetForm() {
                        const form = document.getElementById('myForm');

                        // 텍스트 입력 초기화
                        const textInputs = form.querySelectorAll('input[type="text"]');
                        textInputs.forEach(input => input.value = '');

                        // 날짜 입력 초기화
                        const dateInputs = form.querySelectorAll('input[type="date"]');
                        dateInputs.forEach(input => {
                            const today = new Date();
                            const currentYear = today.getFullYear();
                            const currentMonth = String(today.getMonth() + 1).padStart(2, '0');
                            const currentDay = String(today.getDate()).padStart(2, '0');
                            input.value = `${currentYear}-${currentMonth}-${currentDay}`;

                            if (input.id === 'startDate') {
                                const lastYear = currentYear - 1;
                                input.value = `${lastYear}-${currentMonth}-${currentDay}`;
                            }
                        });

                        // 셀렉트 박스 초기화
                        const selectBoxes = form.querySelectorAll('select');
                        selectBoxes.forEach(select => select.selectedIndex = 0);

                        // 체크박스 초기화
                        const checkboxes = form.querySelectorAll('input[type="checkbox"]');
                        checkboxes.forEach(checkbox => checkbox.checked = false);
                        updateAllCheckbox('age', 'item_age_all');
                        updateAllCheckbox('age2', 'item_age2_all');
                    }

                    // 페이지 로드 시 기본값 설정
                    document.addEventListener('DOMContentLoaded', resetForm);
                </script>

                <br><br>
                <script>
                    // 입력란의 값이 변경될 때마다 호출되는 함수
                    function checkInputs() {
                        var form = document.getElementById('myForm');
                        var queryInputs = form.querySelectorAll('input[type="text"]');
                        var allFilled = true;

                        // 모든 텍스트 입력란이 채워졌는지 확인
                        queryInputs.forEach(function(input) {
                            if (input.value.trim() === "") {
                                allFilled = false;
                            }
                        });

                        var addButton = document.getElementById('addSearchBox');
                        // 모든 입력란이 채워졌다면 버튼을 보이게, 아니면 숨기기
                        if (allFilled) {
                            addButton.style.display = 'inline-block';
                        } else {
                            addButton.style.display = 'none';
                        }
                    }

                    // 초기 상태에서 버튼을 숨김
                    document.getElementById('addSearchBox').style.display = 'none';

                    // 입력란의 값이 변경될 때마다 checkInputs 함수를 호출
                    var textInputs = document.querySelectorAll('input[type="text"]');
                    textInputs.forEach(function(input) {
                        input.addEventListener('input', checkInputs);
                    });

                    document.getElementById('addSearchBox').addEventListener('click', function() {
                        var form = document.getElementById('myForm');
                        var queryInputs = form.querySelectorAll('input[type="text"]');
                        var allFilled = true;

                        // 모든 텍스트 입력란이 채워졌는지 확인
                        queryInputs.forEach(function(input) {
                            if (input.value.trim() === "") {
                                allFilled = false;
                            }
                        });

                        if (allFilled) {
                            var hiddenInputs = form.querySelectorAll('input[type="hidden"]');
                            for (var i = 0; i < hiddenInputs.length; i++) {
                                if (hiddenInputs[i].type === 'hidden') {
                                    hiddenInputs[i].type = 'text';
                                    break; // 첫 번째 hidden 타입의 input 태그만 변경합니다.
                                }
                            }
                            // 새로 추가된 입력란에 이벤트 리스너 추가
                            form.querySelectorAll('input[type="text"]').forEach(function(input) {
                                input.addEventListener('input', checkInputs);
                            });
                        } else {
                            alert("모든 검색어를 입력해 주세요.");
                        }

                        // 입력란 상태 확인하여 버튼 상태 업데이트
                        checkInputs();
                    });

                    // 초기 입력란 상태 확인하여 버튼 상태 설정
                    checkInputs();
                </script>
                <script>
                    document.getElementById('myForm').addEventListener('submit', function(event) {
                        var startDate = new Date(document.getElementById('startDate').value);
                        var endDate = new Date(document.getElementById('endDate').value);
                        let today = new Date();
                        today.setHours(0, 0, 0, 0);
                        var tomorrow = new Date(today.setDate(today.getDate()+1));

                        if ((endDate < startDate)&&(startDate > today || endDate > today)){
                            event.preventDefault();
                            alert("종료 날짜는 시작 날짜보다 이전이 될 수 없고, 선택 날짜는 현재보다 미래가 될 수 없습니다.");
                            window.location.reload();
                        } else if (endDate < startDate) {
                            event.preventDefault();
                            alert("종료 날짜가 시작 날짜보다 과거일 수 없습니다.");
                            window.location.reload();
                        } else if (startDate > tomorrow || endDate > tomorrow) {
                            event.preventDefault();
                            alert("선택 날짜가 현재 날짜 보다 미래일 수 없습니다.");
                            window.location.reload();
                        } else if (startDate < new Date('2016-01-01') || endDate < new Date('2016-01-01')) {
                            event.preventDefault();
                            alert("2016년 이전의 날짜는 선택할 수 없습니다.");
                            window.location.reload();
                        }
                    });
                </script>
                <script>
                    function getCurrentDate() {
                        const today = new Date();
                        const year = today.getFullYear();
                        const month = String(today.getMonth() + 1).padStart(2, '0'); // 월은 0부터 시작하므로 +1 필요
                        const day = String(today.getDate()).padStart(2, '0');
                        return `${year}-${month}-${day}`;
                    }
                    document.addEventListener('DOMContentLoaded', function () {
                        const urlParams = new URLSearchParams(window.location.search);
                        const searchTerm1 = urlParams.get('query1');
                        const searchTerm2 = urlParams.get('query2');
                        const searchTerm3 = urlParams.get('query3');
                        const searchTerm4 = urlParams.get('query4');
                        const searchTerm5 = urlParams.get('query5');

                        const searchInput1 = document.getElementById('query1');
                        const searchInput2 = document.getElementById('hidden1');
                        const searchInput3 = document.getElementById('hidden2');
                        const searchInput4 = document.getElementById('hidden3');
                        const searchInput5 = document.getElementById('hidden4');

                        const startDateInput = document.getElementById('startDate');
                        const endDateInput = document.getElementById('endDate');

                        const selectDayTypeInput = document.getElementById('selectDayType');
                        const selectBoxMopcInput = document.getElementById('select_box_mopc');
                        const selectBoxGenderInput = document.getElementById('select_box_gender');
                        const itemAgeAllCheckbox = document.getElementById('item_age_all');
                        const itemAgeCheckboxes = document.querySelectorAll('input[name="age"]');

                        if (searchTerm1) {
                            searchInput1.value = searchTerm1;
                        }
                        if (searchTerm2) {
                            searchInput2.value = searchTerm2;
                            searchInput2.type = "text";
                        }
                        if (searchTerm3) {
                            searchInput3.value = searchTerm3;
                            searchInput3.type = "text";
                        }
                        if (searchTerm4) {
                            searchInput4.value = searchTerm4;
                            searchInput4.type = "text";
                        }
                        if (searchTerm5) {
                            searchInput5.value = searchTerm5;
                            searchInput5.type = "text";
                        }

                        const startDateParam = urlParams.get('date1');
                        const endDateParam = urlParams.get('date2');
                        const selectDayTypeParam = urlParams.get('select_day_week_month');
                        const selectBoxMopcParam = urlParams.get('device');
                        const selectBoxGenderParam = urlParams.get('gender');
                        const ageParams = urlParams.getAll('age');

                        if (startDateParam) {
                            startDateInput.value = startDateParam;
                        }
                        if (endDateParam) {
                            endDateInput.value = endDateParam;
                        }
                        if (selectDayTypeParam) {
                            selectDayTypeInput.value = selectDayTypeParam;
                        }
                        if (selectBoxMopcParam) {
                            selectBoxMopcInput.value = selectBoxMopcParam;
                        }
                        if (selectBoxGenderParam) {
                            selectBoxGenderInput.value = selectBoxGenderParam;
                        }
                        // 연령 항목 설정
                        if (ageParams.length > 0) {
                            ageParams.forEach(age => {
                                const checkbox = document.getElementById(`item_age_${age}`);
                                if (checkbox) {
                                    checkbox.checked = true;
                                }
                            });
                            updateAllCheckbox('age', 'item_age_all');
                        } else {
                            itemAgeAllCheckbox.checked = true; // 전체 체크박스가 기본으로 체크되도록 설정
                        }
                    });

                    // 페이지 로드 시 기본값 설정
                    document.addEventListener('DOMContentLoaded', (event) => {
                        const today = new Date();
                        const currentYear1 = today.getFullYear()-1;
                        const currentYear2 = today.getFullYear();
                        const currentMonth = String(today.getMonth() + 1).padStart(2, '0');
                        const currentDay = String(today.getDate()).padStart(2, '0');

                        const startDateInput = document.getElementById('startDate');
                        const endDateInput = document.getElementById('endDate');

                        endDateInput.value = `${currentYear2}-${currentMonth}-${currentDay}`;
                        startDateInput.value = `${currentYear1}-${currentMonth}-${currentDay}`;
                    });
                </script>
            </div>
            <div style="display: flex; align-items: flex-start;">
                <!-- 텍스트 부분 -->

                <!-- 필터 부분 -->
                <div style="flex: 1;">
                    <div class="item2">
                        <br>
                        <strong class="title">&nbsp&nbsp기간&nbsp</strong>
                        <input type="date" id="startDate" name="date1" required>&nbsp~&nbsp
                        <input type="date" id="endDate" name="date2" required>
                        <a>&nbsp</a><a>&nbsp</a><a>&nbsp</a><a>&nbsp</a>
                        <strong class="title">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp단위</strong>
                        <label for="selectDayType"></label><select name="select_day_week_month" id="selectDayType">
                        <option selected value="date">일간</option>
                        <option value="week">주간</option>
                        <option value="month">월간</option>
                    </select>
                        <a>&nbsp</a><a>&nbsp</a><a>&nbsp</a><a>&nbsp</a>
                        <strong class="title">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp범위</strong>
                        <span class="select_box v1">
                    <select name="device" id="select_box_mopc">
                        <option selected value="">전체</option>
                        <option value="mo">모바일</option>
                        <option value="pc">PC</option>
                    </select>
                    </span>
                        <a>&nbsp</a><a>&nbsp</a><a>&nbsp</a><a>&nbsp</a>
                        <strong class="title">&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp성별</strong>
                        <select name="gender" id="select_box_gender">
                            <option selected value="">전체</option>
                            <option value="f">여성</option>
                            <option value="m">남성</option>
                        </select>
                        <div class="set_col set_target_chk _checkbox_ui">
                            <div class="set_chk _item_check_div _age_div">
                                <a>&nbsp</a>
                                <strong class="title v2">연령&nbsp&nbsp</strong>
                                <span class="select_chk v1">
                                <input type="checkbox" id="item_age_all" class="chk" name="age" value="" onclick="toggleAllCheckboxes('age', this)">
                                <label class="lbl " for="item_age_all">전체&nbsp</label>
                            </span>
                                <span class="select_chk v1">
                                <input type="checkbox" id="item_age_1" class="chk" name="age" value="1" onclick="updateAllCheckbox('age', 'item_age_all')">
                                <label class="lbl " for="item_age_1">~12&nbsp</label>
                            </span>
                                <span class="select_chk v1">
                                <input type="checkbox" id="item_age_2" class="chk" name="age" value="2" onclick="updateAllCheckbox('age', 'item_age_all')">
                                <label class="lbl " for="item_age_2">13~18&nbsp</label>
                            </span>
                                <span class="select_chk v1">
                                <input type="checkbox" id="item_age_3" class="chk" name="age" value="3" onclick="updateAllCheckbox('age', 'item_age_all')">
                                <label class="lbl " for="item_age_3">19~24&nbsp</label>
                            </span>
                                <span class="select_chk v1">
                                <input type="checkbox" id="item_age_4" class="chk" name="age" value="4" onclick="updateAllCheckbox('age', 'item_age_all')">
                                <label class="lbl " for="item_age_4">25~29&nbsp</label>
                            </span>
                                <span class="select_chk v1">
                                <input type="checkbox" id="item_age_5" class="chk" name="age" value="5" onclick="updateAllCheckbox('age', 'item_age_all')">
                                <label class="lbl " for="item_age_5">30~34&nbsp</label>
                            </span>
                                <span class="select_chk v1">
                                <input type="checkbox" id="item_age_6" class="chk" name="age" value="6" onclick="updateAllCheckbox('age', 'item_age_all')">
                                <label class="lbl " for="item_age_6">35~39&nbsp</label>
                            </span>
                                <span class="select_chk v1">
                                <input type="checkbox" id="item_age_7" class="chk" name="age" value="7" onclick="updateAllCheckbox('age', 'item_age_all')">
                                <label class="lbl " for="item_age_7">40~44&nbsp</label>
                            </span>
                                <span class="select_chk v1">
                                <input type="checkbox" id="item_age_8" class="chk" name="age" value="8" onclick="updateAllCheckbox('age', 'item_age_all')">
                                <label class="lbl " for="item_age_8">45~49&nbsp</label>
                            </span>
                                <span class="select_chk v1">
                                <input type="checkbox" id="item_age_9" class="chk" name="age" value="9" onclick="updateAllCheckbox('age', 'item_age_all')">
                                <label class="lbl " for="item_age_9">50~54&nbsp</label>
                            </span>
                                <span class="select_chk v1">
                                <input type="checkbox" id="item_age_10" class="chk" name="age" value="10" onclick="updateAllCheckbox('age', 'item_age_all')">
                                <label class="lbl " for="item_age_10">55~59&nbsp</label>
                            </span>
                                <span class="select_chk v1">
                                <input type="checkbox" id="item_age_11" class="chk" name="age" value="11" onclick="updateAllCheckbox('age', 'item_age_all')">
                                <label class="lbl " for="item_age_11">60~</label>
                            </span>
                            </div>
                        </div>
                        <script>
                            document.addEventListener('DOMContentLoaded', function () {
                                const urlParams = new URLSearchParams(window.location.search);
                                const searchTerm1 = urlParams.get('query1');
                                const searchTerm2 = urlParams.get('query2');
                                const searchTerm3 = urlParams.get('query3');
                                const searchTerm4 = urlParams.get('query4');
                                const searchTerm5 = urlParams.get('query5');

                                const searchInput1 = document.getElementById('query1');
                                const searchInput2 = document.getElementById('hidden1');
                                const searchInput3 = document.getElementById('hidden2');
                                const searchInput4 = document.getElementById('hidden3');
                                const searchInput5 = document.getElementById('hidden4');

                                const startDateInput = document.getElementById('startDate');
                                const endDateInput = document.getElementById('endDate');

                                const selectDayTypeInput = document.getElementById('selectDayType');
                                const selectBoxMopcInput = document.getElementById('select_box_mopc');
                                const selectBoxGenderInput = document.getElementById('select_box_gender');
                                const itemAgeAllCheckbox = document.getElementById('item_age_all');
                                const itemAgeCheckboxes = document.querySelectorAll('input[name="age"]');

                                if (searchTerm1) {
                                    searchInput1.value = searchTerm1;
                                }
                                if (searchTerm2) {
                                    searchInput2.value = searchTerm2;
                                    searchInput2.type = "text";
                                }
                                if (searchTerm3) {
                                    searchInput3.value = searchTerm3;
                                    searchInput3.type = "text";
                                }
                                if (searchTerm4) {
                                    searchInput4.value = searchTerm4;
                                    searchInput4.type = "text";
                                }
                                if (searchTerm5) {
                                    searchInput5.value = searchTerm5;
                                    searchInput5.type = "text";
                                }

                                const startDateParam = urlParams.get('date1');
                                const endDateParam = urlParams.get('date2');
                                const selectDayTypeParam = urlParams.get('select_day_week_month');
                                const selectBoxMopcParam = urlParams.get('device');
                                const selectBoxGenderParam = urlParams.get('gender');
                                const ageParams = urlParams.getAll('age');

                                if (startDateParam) {
                                    startDateInput.value = startDateParam;
                                }
                                if (endDateParam) {
                                    endDateInput.value = endDateParam;
                                }
                                if (selectDayTypeParam) {
                                    selectDayTypeInput.value = selectDayTypeParam;
                                }
                                if (selectBoxMopcParam) {
                                    selectBoxMopcInput.value = selectBoxMopcParam;
                                }
                                if (selectBoxGenderParam) {
                                    selectBoxGenderInput.value = selectBoxGenderParam;
                                }
                                // 연령 항목 설정
                                if (ageParams.length > 0) {
                                    ageParams.forEach(age => {
                                        const checkbox = document.getElementById(`item_age_${age}`);
                                        if (checkbox) {
                                            checkbox.checked = true;
                                        }
                                    });
                                    updateAllCheckbox('age', 'item_age_all');
                                } else {
                                    itemAgeAllCheckbox.checked = true; // 전체 체크박스가 기본으로 체크되도록 설정
                                }
                            });
                        </script>
                    </div>
                    <br><br>
                    <a href="#" class="ca_btn_go _trend_search_detail_query" id="submitLink">
                        <span class="text" >LETO Trends 검색 데이터 조회</span>
                    </a>
                    <!-- 숨겨진 submit 버튼 -->
                    <button type="submit" id="hiddenSubmit" style="display: none;"></button>
                    <script>
                        function validateCheckboxSelection() {
                            // 첫 번째 그룹 'age'에 대한 검증
                            const ageCheckboxes = document.querySelectorAll('input[name="age"]');
                            const anyAgeChecked = Array.from(ageCheckboxes).some(checkbox => checkbox.checked);

                            // 두 그룹 중 하나라도 선택되지 않은 경우 경고
                            if (!anyAgeChecked) {
                                alert("연령을 선택해주세요.");
                                return false;
                            }
                            return true;
                        }

                        document.getElementById('submitLink').addEventListener('click', function() {
                            if (validateCheckboxSelection()) {
                                document.getElementById('hiddenSubmit').click(); // 숨겨진 submit 버튼 클릭
                            }
                        });
                    </script>
                </div>
            </div>
            <br><br>
        </form>
        <form onsubmit="return clickAlert()" method="get">
            <div>
                <input type="hidden" name="url" id="urlInput" value="">
                <script th:inline="javascript">
                    document.getElementById('urlInput').value = pageUrl();
                    function clickAlert() {
                        if (pageUrl()==="http://localhost:8080/calendar") {
                            alert("검색후 즐겨찾기하실수 있습니다.");
                            return false;
                        } else if (pageUrl()===[[${url1}]]||pageUrl()===[[${url2}]]||pageUrl()===[[${url3}]]||pageUrl()===[[${url4}]]||pageUrl()===[[${url5}]]) {
                            alert("동일한 검색조건은 즐겨찾기하실 수없습니다.")
                            return false;
                        }else if ([[${isTrueAll}]]) {
                            alert("즐겨찾기는 5개까지 추가가능합니다.")
                            return false;
                        }else {
                            alert("즐겨찾기에 추가 되었습니다.");
                        }
                    }
                </script>
                <button class="custom-btn btn-7" type="submit">
                    <i class="far fa-star"></i>
                </button>
                <script>
                    document.getElementById('toggleFavorite').addEventListener('click', function() {
                        var icon = this.querySelector('i');
                        if (icon.classList.contains('far')) {
                            icon.classList.remove('far');
                            icon.classList.add('fas');
                        } else {
                            icon.classList.remove('fas');
                            icon.classList.add('far');
                        }
                    });
                </script>
                <button class="custom-btn btn-7" type="button" onclick="window.location.href='/calendarFavoriteUrl'">
                    <i class="fas fa-list"></i> 즐겨찾기 목록
                </button>
            </div>
        </form>
    </div>
</section>
<button id="dark-mode-toggle" class="fixed-button">
    <i id="dark-mode-icon" class="fas fa-toggle-off"></i> Dark Mode
</button>
<script>
    const darkModeKey = 'darkMode';

    function toggleDarkMode() {
        var icon = document.getElementById("dark-mode-icon");
        var body = document.body;

        if (body.classList.contains("dark-mode")) {
            body.classList.remove("dark-mode");
            body.setAttribute('data-theme', 'light');
            icon.classList.remove("fa-toggle-on");
            icon.classList.add("fa-toggle-off");
            localStorage.setItem(darkModeKey, 'false');
        } else {
            body.classList.add("dark-mode");
            body.setAttribute('data-theme', 'dark');
            icon.classList.remove("fa-toggle-off");
            icon.classList.add("fa-toggle-on");
            localStorage.setItem(darkModeKey, 'true');
        }

        // 다크 모드와 라이트 모드에 따라 차트의 배경색 변경
        var chartContainer = document.getElementById("container");
        var chart = chartContainer.anychart;

        if (body.classList.contains("dark-mode")) {
            chart.background().fill("#18233B");
        } else {
            chart.background().fill("#FFFFFF"); // 라이트 모드일 때 기본 배경색으로 변경
        }
    }

    function loadDarkMode() {
        var isDarkMode = localStorage.getItem(darkModeKey) === 'true';
        var icon = document.getElementById("dark-mode-icon");
        var body = document.body;

        if (isDarkMode) {
            body.classList.add("dark-mode");
            body.setAttribute('data-theme', 'dark');
            icon.classList.remove("fa-toggle-off");
            icon.classList.add("fa-toggle-on");
        } else {
            body.classList.remove("dark-mode");
            body.setAttribute('data-theme', 'light');
            icon.classList.remove("fa-toggle-on");
            icon.classList.add("fa-toggle-off");
        }
    }

    document.addEventListener("DOMContentLoaded", function() {
        loadDarkMode();

        // 다크 모드 토글 버튼에 이벤트 리스너 추가
        document.getElementById("dark-mode-toggle").addEventListener("click", toggleDarkMode);
    });

</script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        // 초기 상태에서 버튼을 숨김
        var addButton = document.getElementById('addSearchBox');
        addButton.style.display = 'none';

        // 입력란의 값이 변경될 때마다 호출되는 함수
        function checkInputs() {
            var form = document.getElementById('myForm');
            var queryInputs = form.querySelectorAll('input[type="text"]');
            var allFilled = true;

            // 모든 텍스트 입력란이 채워졌는지 확인
            queryInputs.forEach(function(input) {
                if (input.value.trim() === "") {
                    allFilled = false;
                }
            });

            // 모든 입력란이 채워졌다면 버튼을 보이게, 아니면 숨기기
            if (allFilled) {
                addButton.style.display = 'inline-block';
            } else {
                addButton.style.display = 'none';
            }
        }

        // 입력란의 값이 변경될 때마다 checkInputs 함수를 호출
        var textInputs = document.querySelectorAll('input[type="text"]');
        textInputs.forEach(function(input) {
            input.addEventListener('input', checkInputs);
        });

        // 검색 데이터 조회 후에도 입력 상태 확인하여 버튼 상태 업데이트
        document.getElementById('submitLink').addEventListener('click', function() {
            setTimeout(function() {
                checkInputs();
            }, 100); // 100ms 딜레이를 줘서 데이터 조회 후에도 올바르게 동작하도록 함
        });

        // 초기 입력란 상태 확인하여 버튼 상태 설정
        checkInputs();
    });
</script>
<script>
    document.getElementById('myForm').addEventListener('submit', function(event) {
        var startDate = new Date(document.getElementById('startDate').value);
        var endDate = new Date(document.getElementById('endDate').value);
        var selectDayType = document.getElementById('selectDayType').value;

        let today = new Date();
        today.setHours(0, 0, 0, 0);
        var tomorrow = new Date(today.setDate(today.getDate() + 1));

        if (selectDayType === 'date') {
            var timeDiff = endDate.getTime() - startDate.getTime();
            var dayDiff = timeDiff / (1000 * 3600 * 24);

            if (dayDiff > 91) {
                alert("일간 검색 시 최대 3개월까지 검색할 수 있습니다.");
                event.preventDefault();
            }
        } else if (selectDayType === 'week') {
            var yearGap = endDate.getFullYear() - startDate.getFullYear();
            if (yearGap > 2 || (yearGap === 2 && endDate.getMonth() > startDate.getMonth()) || (yearGap === 2 && endDate.getMonth() === startDate.getMonth() && endDate.getDate() > startDate.getDate())) {
                alert("주간 검색 시 최대 2년까지 검색할 수 있습니다.");
                event.preventDefault();
            }
        }

        if (endDate < startDate && (startDate > today || endDate > today)) {
            event.preventDefault();
            alert("종료 날짜는 시작 날짜보다 이전이 될 수 없고, 선택 날짜는 현재보다 미래가 될 수 없습니다.");
            window.location.reload();
        } else if (endDate < startDate) {
            event.preventDefault();
            alert("종료 날짜가 시작 날짜보다 과거일 수 없습니다.");
            window.location.reload();
        } else if (startDate > tomorrow || endDate > tomorrow) {
            event.preventDefault();
            alert("선택 날짜가 현재 날짜 보다 미래일 수 없습니다.");
            window.location.reload();
        } else if (startDate < new Date('2016-01-01') || endDate < new Date('2016-01-01')) {
            event.preventDefault();
            alert("2016년 이전의 날짜는 선택할 수 없습니다.");
            window.location.reload();
        }
    });
</script>

<!-- 히트맵 캘린더를 추가할 div -->
<script th:inline="javascript">
    anychart.onDocumentReady(function() {
        var titles = /*[[${title}]]*/ []; // 열 제목 리스트
        var years = /*[[${years}]]*/ []; // 연도 리스트
        var values = [
            /*[[${value1}]]*/,
            /*[[${value2}]]*/,
            /*[[${value3}]]*/,
            /*[[${value4}]]*/,
            /*[[${value5}]]*/
        ];

        // selectDayType 값 가져오기
        var selectDayType = document.getElementById('selectDayType').value;
        console.log("selectDayType:", selectDayType);

        // 데이터 형식에 맞춰 배열 생성
        var data = [];
        let total = titles.length;

        for (var i = 0; i < titles.length; i++) {
            for (var j = 0; j < years.length; j++) {
                var dateValue = years[j];
                console.log("Original dateValue:", dateValue, "Type:", typeof dateValue);
                console.log(/*[[${timeunit}]]*/);

                // timeunit이 "month"인 경우 년도와 월까지만 사용
                if ([[${timeunit}]] === "month" && typeof dateValue === 'string') {
                    dateValue = dateValue.slice(0, 7);
                }
                console.log("Adding date:", dateValue, "Title:", titles[i]);
                // 데이터 배열에 추가
                data.push([dateValue, titles[i], values[total - i - 1][j]]);
            }
        }

        // 데이터 세트 생성
        var dataSet = anychart.data.set(data);

        // Heatmap 생성
        var chart = anychart.heatMap(dataSet);

        // Heatmap 설정
        chart.title("");

        // create and configure the color scale.
        var customColorScale = anychart.scales.linearColor();
        customColorScale.colors(["#ACE8D4", "#00726A"]);

        // set the color scale as the color scale of the chart
        chart.colorScale(customColorScale);

        // Heatmap 그리기
        chart.container("container");
        chart.draw();
    });
</script>
<div id="container"></div>

<br><br><br><br><br>
<section class="info_section layout_padding2">
    <div class="container_1">
        <div class="row">
            <div class="col-md-6 col-lg-3 info_col">
                <div class="info_contact">
                    <h4>
                        Address
                    </h4>
                    <div class="contact_link_box">
                        <a href="">
                            <i class="fa fa-phone" aria-hidden="true"></i>
                            <span>
                  Call +82 01023186310
                </span>
                        </a>
                        <a href="">
                            <i class="fa fa-envelope" aria-hidden="true"></i>
                            <span>
                  qjawns314@naver.com
                </span>
                        </a>
                    </div>
                </div>
                <div class="info_social">
                    <a>
                        <i class="fa fa-facebook" aria-hidden="true"></i>
                    </a>
                    <a>
                        <i class="fa fa-twitter" aria-hidden="true"></i>
                    </a>
                    <a>
                        <i class="fa fa-linkedin" aria-hidden="true"></i>
                    </a>
                    <a>
                        <i class="fa fa-instagram" aria-hidden="true"></i>
                    </a>
                </div>
            </div>
            <div class="col-md-6 col-lg-3 info_col">
                <div class="info_detail">
                    <h4>
                        Info
                    </h4>
                    <p>
                        Our search trend website identifies real-time user interests and provides the latest trends. Quickly see what topics and search terms are trending worldwide.
                    </p>
                </div>
            </div>
            <div class="col-md-6 col-lg-2 mx-auto info_col">
                <div class="info_link_box">
                    <h4>
                        Links
                    </h4>
                    <div class="info_links">
                        <a class="active" href="/">
                            Home
                        </a>
                        <a class="" href="about">
                            About
                        </a>
                        <a class="" href="service">
                            Analysis
                        </a>
                        <a class="" href="why">
                            Why Us
                        </a>
                        <a class="" href="team">
                            Team
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- jQery -->
<script type="text/javascript" src="/js/jquery-3.4.1.min.js"></script>
<!-- popper js -->
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous">
</script>
<!-- bootstrap js -->
<script type="text/javascript" src="/js/bootstrap.js"></script>
<!-- owl slider -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js">
</script>
<!-- custom js -->
<script type="text/javascript" src="/js/custom.js"></script>
<!-- Google Map -->
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCh39n5U-4IoWpsVGUHWdqB6puEkhRLdmI&callback=myMap">
</script>
<!-- End Google Map -->

</body>

</html>